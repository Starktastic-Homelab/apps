controllers:
  main:
    containers:
      main:
        image:
          repository: lscr.io/linuxserver/jellyfin
          tag: 10.11.6
          digest: sha256:45814a5515fdb81cd41f5db946cfd53a3c5e91f0665b40b55bae30cab4b3cd2e
        env:
          DOCKER_MODS: "linuxserver/mods:jellyfin-opencl-intel"
          JELLYFIN_PublishedServerUrl: "https://benplus.app"
        resources:
          limits:
            gpu.intel.com/i915: "1"
        probes:
          liveness:
            enabled: true
            type: HTTP
            path: /health
            port: 8096
          readiness:
            enabled: true
            type: HTTP
            path: /health
            port: 8096
          startup:
            enabled: true
            type: HTTP
            path: /health
            port: 8096
            spec:
              initialDelaySeconds: 30
              failureThreshold: 60
              periodSeconds: 10

service:
  main:
    controller: main
    ports:
      http:
        port: 8096
  discovery:
    controller: main
    type: ClusterIP
    ports:
      discovery:
        port: 7359
        protocol: UDP

persistence:
  config:
    enabled: false
  jellyfin-config:
    existingClaim: jellyfin-config
    globalMounts:
      - path: /config
  media:
    existingClaim: media-library-pvc
    globalMounts:
      - path: /data
  transcode:
    type: emptyDir
    sizeLimit: 20Gi
    globalMounts:
      - path: /config/cache/transcodes
